# SONSHIガチャ ページ構成

## ユーザー向けページ

### / （トップページ）
パチスロホール風のエントランス。
- ネオンが光る入り口のようなデザイン
- 「ENTER」ボタンで中に入る演出
- 新着カード、ピックアップの表示
- ガチャへの導線

### /gacha （ガチャ選択ページ）
- シングルガチャ / 連続ガチャの選択
- パチスロの機種選択画面のようなUI
- 各ガチャの必要チケット数表示
- 現在のチケット残数表示

### /gacha/single （シングルガチャ）
- 演出映像再生
- 結果表示（デジタルカード）
- 「もう1回」ボタン
- UMA ROYALEのガチャ画面を参考に

### /gacha/multi （連続ガチャ選択）
- 2連 / 5連 / 10連の選択
- 各種の必要チケット数
- それぞれの特徴説明

### /gacha/multi/[sessionId] （連続ガチャ実行中）
- 演出映像再生エリア
- 進捗表示（3/10）
- 「NEXT」ボタン（パチスロのレバー風）
- これまでの結果ミニカード表示
- 全回終了後にまとめ結果表示

### /collection （カードコレクション）
- 保有カードのグリッド表示
- レア度でフィルタ
- 人物名でフィルタ
- スタイルでフィルタ
- 未所持カードはシルエット表示

### /collection/[cardId] （カード詳細）
- カード画像の拡大表示
- カード情報（名前、レア度、人物名、スタイル）
- シリアルナンバー（#3/10）
- 取得日時
- 総発行枚数 / 最大発行枚数

### /mypage （マイページ）
- ユーザー情報
- チケット残数
- カード保有数
- 各機能への導線

### /mypage/invite （友達紹介）
- 紹介コード表示
- コピーボタン
- LINE共有ボタン
- X（Twitter）共有ボタン
- 紹介実績一覧

### /mypage/tickets （チケット管理）
- チケット残数
- チケット購入ボタン
- 購入履歴
- フリーチケット獲得履歴

### /mypage/history （ガチャ履歴）
- ガチャ結果の時系列表示
- シングル / 連続の区別
- 獲得カードのサムネイル

### /purchase （チケット購入）
- チケットパック選択（1枚、5枚、10枚、30枚など）
- one.lat決済
- 購入完了画面

### /invite/[code] （紹介リンクランディング）
- 紹介者の情報
- サイトの紹介
- 会員登録への導線
- 「登録で双方にフリーチケット1枚！」

## 管理者向けページ

### /admin （管理者ダッシュボード）
- 売上サマリー
- ユーザー数
- ガチャ回数
- 日別グラフ

### /admin/cards （カード管理）
- カード一覧テーブル
- レア度・発行状況でフィルタ
- 新規カード登録ボタン
- 各カードの編集・削除

### /admin/cards/new （カード新規登録）
- カード名入力
- 画像アップロード
- レア度選択
- 最大発行枚数設定
- 人物名入力
- スタイル選択

### /admin/cards/[id] （カード詳細・保有者一覧）
- カード情報の編集
- 発行状況（現在 / 最大）
- 保有者一覧テーブル
- シリアル番号、ユーザー名、取得日時
- 検索機能

### /admin/users （ユーザー管理）
- ユーザー一覧テーブル
- 検索（名前、メール）
- チケット残数表示
- チケット手動付与
- ユーザー詳細への導線

### /admin/users/[id] （ユーザー詳細）
- ユーザー情報
- チケット残数・履歴
- ガチャ履歴
- 保有カード一覧
- 紹介実績

### /admin/probability （確率設定）
- レア度別の確率スライダー
- 合計100%のバリデーション
- RTP設定
- 天井設定
- 変更履歴

### /admin/referrals （紹介管理）
- 紹介一覧
- ステータスフィルタ
- 紹介者・被紹介者の情報

### /admin/stats （統計詳細）
- 期間別の売上グラフ
- レア度別の排出数グラフ
- ユーザーアクティビティ
- CSV出力

## API Routes

### ガチャ関連
- POST /api/gacha/single - シングルガチャ実行
- POST /api/gacha/multi/start - 連続ガチャ開始（結果事前決定）
- POST /api/gacha/multi/[sessionId]/next - 次の1回の結果取得
- GET /api/gacha/multi/[sessionId] - セッション状態取得

### カード関連
- GET /api/cards - カード一覧
- GET /api/cards/[id] - カード詳細
- GET /api/collection - 自分のカードコレクション

### 紹介関連
- GET /api/referral/code - 自分の紹介コード取得
- POST /api/referral/verify - 紹介コード検証
- GET /api/referral/stats - 紹介実績

### LINE連携
- POST /api/line/webhook - LINE Webhook受信
- POST /api/line/link - LINEアカウント紐付け

### 管理者API
- CRUD /api/admin/cards
- GET /api/admin/users
- PUT /api/admin/probability
- GET /api/admin/stats
- POST /api/admin/tickets/grant - チケット手動付与
